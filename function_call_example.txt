1> Chat0 = chat_gpte:new().
#{payloads => [],
  request =>
      #{messages => [],model => <<"gpt-3.5-turbo">>,
        temperature => 0.7}}
2> Function1 = gpte_functions:new(
2>     list_rooms
2>   , <<"list rooms in the house.">>
2>   , fun(#{house_id:=42}, _State) ->
2>         jsone:encode([
2>             #{id=>1, name=><<"main room">>}
2>           , #{id=>2, name=><<"klassen's room">>}
2>         ])
2>     end
2>   , [{
2>         integer
2>       , house_id
2>       , <<"id of the house">>
2>       , true
2>     }]
2> ).
{integer,house_id,<<"id of the house">>,true}
#{description => <<"list rooms in the house.">>,
  function => #Fun<erl_eval.43.65746770>,name => list_rooms,
  properties =>
      #{house_id =>
            #{description => <<"id of the house">>,type => integer}},
  required => #{house_id => []},
  state => []}
3> Function2 = gpte_functions:new(
3>     update_color
3>   , <<"change the lighting color of the selected room.">>
3>   , fun
3>         (#{house_id:=42, room_id:=2, color:=Color}, Color) ->
3>             throw(#{
3>                 reason => same_color
3>               , detail => list_to_binary(io_lib:format(
3>                     "The room color is already ~s."
3>                   , [Color]
3>                 ))
3>             });
3>         (#{house_id:=42, room_id:=2, color:=Color}, _State) ->
3>             Res = list_to_binary(io_lib:format(
3>                 "The room color has been changed to ~s."
3>               , [Color]
3>             )),
3>             {Res, Color};
3>         (#{house_id:=42, room_id:=2}, white) ->
3>             throw(#{
3>                 reason => same_color
3>               , detail => <<"The room color is already white.">>
3>             });
3>         (#{house_id:=42, room_id:=2}, _State) ->
3>             Res = <<"The room color has been changed to white.">>,
3>             {Res, white};
3>         (_, _) ->
3>             throw(#{
3>                 reason => forbidden
3>               , detail => <<"You can't do anything to that room.">>
3>             })
3>     end
3>   , [
3>         {
3>             integer
3>           , house_id
3>           , <<"id of the house">>
3>           , true
3>         }
3>       , {
3>             integer
3>           , room_id
3>           , <<"id of the room">>
3>           , true
3>         }
3>       , {
3>             string
3>           , color
3>           , <<"name of the color to change. leave it empty for default.">>
3>           , false
3>         }
3>     ]
3>   , white
3> ).
{integer,house_id,<<"id of the house">>,true}
{integer,room_id,<<"id of the room">>,true}
{string,color,<<"name of the color to change. leave it empty for default.">>,
        false}
#{description =>
      <<"change the lighting color of the selected room.">>,
  function => #Fun<erl_eval.43.65746770>,name => update_color,
  properties =>
      #{color =>
            #{description =>
                  <<"name of the color to change. leave it empty for default.">>,
              type => string},
        house_id =>
            #{description => <<"id of the house">>,type => integer},
        room_id =>
            #{description => <<"id of the room">>,type => integer}},
  required => #{house_id => [],room_id => []},
  state => white}
4> Chat1 = chat_gpte:function(Function1, Chat0).
#{functions =>
      #{<<"list_rooms">> =>
            #{description => <<"list rooms in the house.">>,
              function => #Fun<erl_eval.43.65746770>,name => list_rooms,
              properties =>
                  #{house_id =>
                        #{description => <<"id of the house">>,
                          type => integer}},
              required => #{house_id => []},
              state => []}},
  payloads => [],
  request =>
      #{functions =>
            [#{description => <<"list rooms in the house.">>,
               name => list_rooms,
               parameters =>
                   #{properties =>
                         #{house_id =>
                               #{description => <<"id of the house">>,
                                 type => integer}},
                     required => [house_id],
                     type => object}}], 
        messages => [],model => <<"gpt-3.5-turbo">>,
        temperature => 0.7}}
5> Chat2 = chat_gpte:function(Function2, Chat1).
#{functions =>
      #{<<"list_rooms">> =>
            #{description => <<"list rooms in the house.">>,
              function => #Fun<erl_eval.43.65746770>,name => list_rooms,
              properties =>
                  #{house_id =>
                        #{description => <<"id of the house">>,
                          type => integer}},
              required => #{house_id => []},
              state => []},
        <<"update_color">> =>
            #{description =>
                  <<"change the lighting color of the selected room.">>,
              function => #Fun<erl_eval.43.65746770>,name => update_color,
              properties =>
                  #{color =>
                        #{description =>
                              <<"name of the color to change. leave it empty for default.">>,
                          type => string},
                    house_id =>
                        #{description => <<"id of the house">>, 
                          type => integer},
                    room_id =>
                        #{description => <<"id of the room">>,
                          type => integer}},
              required => #{house_id => [],room_id => []},
              state => white}},
  payloads => [],
  request =>
      #{functions =>
            [#{description =>
                   <<"change the lighting color of the selected room.">>,
               name => update_color,
               parameters =>
                   #{properties =>
                         #{color =>
                               #{description =>
                                     <<"name of the color to change. leave it empty for default.">>,
                                 type => string},
                           house_id =>
                               #{description => <<"id of the house">>,
                                 type => integer},
                           room_id =>
                               #{description => <<"id of the room">>,
                                 type => integer}},
                     required => [house_id,room_id],
                     type => object}},
             #{description => <<"list rooms in the house.">>,
               name => list_rooms, 
               parameters =>
                   #{properties =>
                         #{house_id =>
                               #{description => <<"id of the house">>,
                                 type => integer}},
                     required => [house_id],
                     type => object}}],
        messages => [],model => <<"gpt-3.5-turbo">>,
        temperature => 0.7}}
6> Chat3 = chat_gpte:system(<<"You are an ai assistant of klassen living at house id 42.">>, Chat2).
#{functions =>
      #{<<"list_rooms">> =>
            #{description => <<"list rooms in the house.">>,
              function => #Fun<erl_eval.43.65746770>,name => list_rooms,
              properties =>
                  #{house_id =>
                        #{description => <<"id of the house">>,
                          type => integer}},
              required => #{house_id => []},
              state => []},
        <<"update_color">> =>
            #{description =>
                  <<"change the lighting color of the selected room.">>,
              function => #Fun<erl_eval.43.65746770>,name => update_color,
              properties =>
                  #{color =>
                        #{description =>
                              <<"name of the color to change. leave it empty for default.">>,
                          type => string},
                    house_id =>
                        #{description => <<"id of the house">>, 
                          type => integer},
                    room_id =>
                        #{description => <<"id of the room">>,
                          type => integer}},
              required => #{house_id => [],room_id => []},
              state => white}},
  payloads => [],
  request =>
      #{functions =>
            [#{description =>
                   <<"change the lighting color of the selected room.">>,
               name => update_color,
               parameters =>
                   #{properties =>
                         #{color =>
                               #{description =>
                                     <<"name of the color to change. leave it empty for default.">>,
                                 type => string},
                           house_id =>
                               #{description => <<"id of the house">>,
                                 type => integer},
                           room_id =>
                               #{description => <<"id of the room">>,
                                 type => integer}},
                     required => [house_id,room_id],
                     type => object}},
             #{description => <<"list rooms in the house.">>,
               name => list_rooms, 
               parameters =>
                   #{properties =>
                         #{house_id =>
                               #{description => <<"id of the house">>,
                                 type => integer}},
                     required => [house_id],
                     type => object}}],
        messages =>
            [#{content =>
                   <<"You are an ai assistant of klassen living at house id 42.">>,
               role => system}],
        model => <<"gpt-3.5-turbo">>,temperature => 0.7}}
7> {Res1, Chat4} = chat_gpte:ask(<<"What is my room id?">>, Chat3).
=WARNING REPORT==== 6-Dec-2023::23:30:43.324427 ===
Description: "Authenticity is not established by certificate path validation"
     Reason: "Option {verify, verify_peer} and cacertfile/cacerts is missing"

{<<"Your room id is 2.">>,
 #{functions =>
       #{<<"list_rooms">> =>
             #{description => <<"list rooms in the house.">>,
               function => #Fun<erl_eval.43.65746770>,name => list_rooms,
               properties =>
                   #{house_id =>
                         #{description => <<"id of the house">>,
                           type => integer}},
               required => #{house_id => []},
               state => []},
         <<"update_color">> =>
             #{description =>
                   <<"change the lighting color of the selected room.">>,
               function => #Fun<erl_eval.43.65746770>,name => update_color,
               properties =>
                   #{color =>
                         #{description =>
                               <<"name of the color to change. leave it empty for default.">>,
                           type => string},
                     house_id =>
                         #{description => <<"id of the house">>,
                           type => integer},
                     room_id =>
                         #{description => <<"id of the room">>,
                           type => integer}},
               required => #{house_id => [],room_id => []},
               state => white}},
   payloads =>
       [#{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => <<"Your room id is 2.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873044,
          <<"id">> => <<"chatcmpl-8SnDAQTDYB5O3jGZKYsLpib03DHQG">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 8,<<"prompt_tokens">> => 192,
                <<"total_tokens">> => 200}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"house_id\": 42\n}">>,
                             <<"name">> => <<"list_rooms">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873043,
          <<"id">> => <<"chatcmpl-8SnD9WI6OnhGExk2xJ0WzY9v91rXn">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 16,<<"prompt_tokens">> => 134,
                <<"total_tokens">> => 150}}],
   request =>
       #{functions =>
             [#{description =>
                    <<"change the lighting color of the selected room.">>,
                name => update_color,
                parameters =>
                    #{properties =>
                          #{color =>
                                #{description =>
                                      <<"name of the color to change. leave it empty for default.">>,
                                  type => string},
                            house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer},
                            room_id =>
                                #{description => <<"id of the room">>,
                                  type => integer}},
                      required => [house_id,room_id],
                      type => object}},
              #{description => <<"list rooms in the house.">>,
                name => list_rooms,
                parameters =>
                    #{properties =>
                          #{house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer}},
                      required => [house_id],
                      type => object}}],
         messages =>
             [#{content => <<"Your room id is 2.">>,role => assistant},
              #{content =>
                    <<"{\"payload\":\"[{\\\"id\\\":1,\\\"name\\\":\\\"main room\\\"},{\\\"id\\\":2,\\\"name\\\":\\\"klassen's room\\\"}]\","...>>,
                name => <<"list_rooms">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> => <<"{\n  \"house_id\": 42\n}">>,
                      <<"name">> => <<"list_rooms">>},
                role => assistant},
              #{content => <<"What is my room id?">>,role => user},
              #{content =>
                    <<"You are an ai assistant of klassen living at house id 42.">>,
                role => system}],
         model => <<"gpt-3.5-turbo">>,temperature => 0.7}}}
8> {Res2, Chat5} = chat_gpte:ask(<<"Can you change my room color to blue?">>, Chat4).
{<<"Sure! I have changed your room color to blue.">>,
 #{functions =>
       #{<<"list_rooms">> =>
             #{description => <<"list rooms in the house.">>,
               function => #Fun<erl_eval.43.65746770>,name => list_rooms,
               properties =>
                   #{house_id =>
                         #{description => <<"id of the house">>,
                           type => integer}},
               required => #{house_id => []},
               state => []},
         <<"update_color">> =>
             #{description =>
                   <<"change the lighting color of the selected room.">>,
               function => #Fun<erl_eval.43.65746770>,name => update_color,
               properties =>
                   #{color =>
                         #{description =>
                               <<"name of the color to change. leave it empty for default.">>,
                           type => string},
                     house_id =>
                         #{description => <<"id of the house">>,
                           type => integer},
                     room_id =>
                         #{description => <<"id of the room">>,
                           type => integer}},
               required => #{house_id => [],room_id => []},
               state => <<"blue">>}},
   payloads =>
       [#{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"Sure! I have changed your room color to blue.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873046,
          <<"id">> => <<"chatcmpl-8SnDC9TAf8z0GRMr1TOIN8cSvwdji">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 12,<<"prompt_tokens">> => 272,
                <<"total_tokens">> => 284}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873045,
          <<"id">> => <<"chatcmpl-8SnDBZhQFVeNea07NsanaBwaJvfMN">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 216,
                <<"total_tokens">> => 247}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => <<"Your room id is 2.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873044,
          <<"id">> => <<"chatcmpl-8SnDAQTDYB5O3jGZKYsLpib03DHQG">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 8,<<"prompt_tokens">> => 192,
                <<"total_tokens">> => 200}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"house_id\": 42\n}">>,
                             <<"name">> => <<"list_rooms">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873043,
          <<"id">> => <<"chatcmpl-8SnD9WI6OnhGExk2xJ0WzY9v91rXn">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 16,<<"prompt_tokens">> => 134,
                <<"total_tokens">> => 150}}],
   request =>
       #{functions =>
             [#{description =>
                    <<"change the lighting color of the selected room.">>,
                name => update_color,
                parameters =>
                    #{properties =>
                          #{color =>
                                #{description =>
                                      <<"name of the color to change. leave it empty for default.">>,
                                  type => string},
                            house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer},
                            room_id =>
                                #{description => <<"id of the room">>,
                                  type => integer}},
                      required => [house_id,room_id],
                      type => object}},
              #{description => <<"list rooms in the house.">>,
                name => list_rooms,
                parameters =>
                    #{properties =>
                          #{house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer}},
                      required => [house_id],
                      type => object}}],
         messages =>
             [#{content =>
                    <<"Sure! I have changed your room color to blue.">>,
                role => assistant},
              #{content =>
                    <<"{\"payload\":\"The room color has been changed to blue.\",\"sccess\":true}">>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant}, 
              #{content => <<"Can you change my room color to blue?">>,
                role => user},
              #{content => <<"Your room id is 2.">>,role => assistant},
              #{content =>
                    <<"{\"payload\":\"[{\\\"id\\\":1,\\\"name\\\":\\\"main room\\\"},{\\\"id\\\":2,\\\"name\\\":\\\"klas"...>>,
                name => <<"list_rooms">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> => <<"{\n  \"house_id\": 42\n}">>,
                      <<"name">> => <<"list_rooms">>},
                role => assistant},
              #{content => <<"What is my room id?">>,role => user},
              #{content => 
                    <<"You are an ai assistant of klassen living at house id 42.">>,
                role => system}],
         model => <<"gpt-3.5-turbo">>,temperature => 0.7}}}
9> {Res3, Chat6} = chat_gpte:ask(<<"Can you change my room color to blue again?">>, Chat5).
{<<"I'm sorry, but your room color is already blue. There is no need to change it again.">>,
 #{functions =>
       #{<<"list_rooms">> =>
             #{description => <<"list rooms in the house.">>,
               function => #Fun<erl_eval.43.65746770>,name => list_rooms,
               properties =>
                   #{house_id =>
                         #{description => <<"id of the house">>,
                           type => integer}},
               required => #{house_id => []},
               state => []},
         <<"update_color">> =>
             #{description =>
                   <<"change the lighting color of the selected room.">>,
               function => #Fun<erl_eval.43.65746770>,name => update_color,
               properties =>
                   #{color =>
                         #{description =>
                               <<"name of the color to change. leave it empty for default.">>,
                           type => string},
                     house_id =>
                         #{description => <<"id of the house">>,
                           type => integer},
                     room_id =>
                         #{description => <<"id of the room">>,
                           type => integer}},
               required => #{house_id => [],room_id => []},
               state => <<"blue">>}},
   payloads =>
       [#{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"I'm sorry, but your room color is already blue. There is no need to change it again.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873049,
          <<"id">> => <<"chatcmpl-8SnDFBBBLmRNgqTkZrJUtBMjtPnlX">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 22,<<"prompt_tokens">> => 367,
                <<"total_tokens">> => 389}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873047,
          <<"id">> => <<"chatcmpl-8SnDDleL8WV2O58WFjKU4nNVgm93U">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 301,
                <<"total_tokens">> => 332}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"Sure! I have changed your room color to blue.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873046,
          <<"id">> => <<"chatcmpl-8SnDC9TAf8z0GRMr1TOIN8cSvwdji">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 12,<<"prompt_tokens">> => 272,
                <<"total_tokens">> => 284}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873045,
          <<"id">> => <<"chatcmpl-8SnDBZhQFVeNea07NsanaBwaJvfMN">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> => 
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 216,
                <<"total_tokens">> => 247}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => <<"Your room id is 2.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873044,
          <<"id">> => <<"chatcmpl-8SnDAQTDYB5O3jGZKYsLpib03DHQG">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 8,<<"prompt_tokens">> => 192,
                <<"total_tokens">> => 200}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"house_id\": 42\n}">>,
                             <<"name">> => <<"list_rooms">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873043,
          <<"id">> => <<"chatcmpl-8SnD9WI6OnhGExk2xJ0WzY9v91rXn">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 16,<<"prompt_tokens">> => 134,
                <<"total_tokens">> => 150}}],
   request =>
       #{functions =>
             [#{description =>
                    <<"change the lighting color of the selected room.">>,
                name => update_color,
                parameters =>
                    #{properties =>
                          #{color =>
                                #{description =>
                                      <<"name of the color to change. leave it empty for default.">>,
                                  type => string},
                            house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer},
                            room_id =>
                                #{description => <<"id of the room">>,
                                  type => integer}},
                      required => [house_id,room_id],
                      type => object}},
              #{description => <<"list rooms in the house.">>,
                name => list_rooms,
                parameters =>
                    #{properties =>
                          #{house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer}},
                      required => [house_id],
                      type => object}}],
         messages =>
             [#{content =>
                    <<"I'm sorry, but your room color is already blue. There is no need to change it again.">>,
                role => assistant},
              #{content =>
                    <<"{\"detail\":\"<<\\\"The room color is already blue.\\\">>\",\"reaseon\":\"same_color\",\"sccess\":fals"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content =>
                    <<"Can you change my room color to blue again?">>,
                role => user},
              #{content =>
                    <<"Sure! I have changed your room color to blue.">>,
                role => assistant},
              #{content =>
                    <<"{\"payload\":\"The room color has been changed to blue.\",\"sccess\":true}">>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content => <<"Can you change my room color to blue?">>,
                role => user},
              #{content => <<"Your room id is 2.">>,role => assistant},
              #{content =>
                    <<"{\"payload\":\"[{\\\"id\\\":1,\\\"name\\\":\\\"main room\\\"},{\\\"id\\\":2"...>>,
                name => <<"list_rooms">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> => <<"{\n  \"house_id\": 42\n}">>,
                      <<"name">> => <<"list_rooms">>},
                role => assistant},
              #{content => <<"What is my room id?">>,role => user},
              #{content =>
                    <<"You are an ai assistant of klassen living at"...>>,
                role => system}],
         model => <<"gpt-3.5-turbo">>,temperature => 0.7}}}
10> {Res4, Chat7} = chat_gpte:ask(<<"Can you change the main room color to blue?">>, Chat6).
{<<"I'm sorry, but I am not able to change the color of the main room.">>,
 #{functions =>
       #{<<"list_rooms">> =>
             #{description => <<"list rooms in the house.">>,
               function => #Fun<erl_eval.43.65746770>,name => list_rooms,
               properties =>
                   #{house_id =>
                         #{description => <<"id of the house">>,
                           type => integer}},
               required => #{house_id => []},
               state => []},
         <<"update_color">> =>
             #{description =>
                   <<"change the lighting color of the selected room.">>,
               function => #Fun<erl_eval.43.65746770>,name => update_color,
               properties =>
                   #{color =>
                         #{description =>
                               <<"name of the color to change. leave it empty for default.">>,
                           type => string},
                     house_id =>
                         #{description => <<"id of the house">>,
                           type => integer},
                     room_id =>
                         #{description => <<"id of the room">>,
                           type => integer}},
               required => #{house_id => [],room_id => []},
               state => <<"blue">>}},
   payloads =>
       [#{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"I'm sorry, but I am not able to change the color of the main room.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873051,
          <<"id">> => <<"chatcmpl-8SnDHMs2PRfLPj9FA2kmNpYNefRUO">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 19,<<"prompt_tokens">> => 474,
                <<"total_tokens">> => 493}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 1\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873050,
          <<"id">> => <<"chatcmpl-8SnDGgsCYXIDjv6EVRn5cSM0RdI3m">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 406,
                <<"total_tokens">> => 437}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"I'm sorry, but your room color is already blue. There is no need to change i"...>>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873049,
          <<"id">> => <<"chatcmpl-8SnDFBBBLmRNgqTkZrJUtBMjtPnlX">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 22,<<"prompt_tokens">> => 367,
                <<"total_tokens">> => 389}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>, 
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873047, 
          <<"id">> => <<"chatcmpl-8SnDDleL8WV2O58WFjKU4nNVgm93U">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 301,
                <<"total_tokens">> => 332}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"Sure! I have changed your room color to blue.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873046,
          <<"id">> => <<"chatcmpl-8SnDC9TAf8z0GRMr1TOIN8cSvwdji">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 12,<<"prompt_tokens">> => 272,
                <<"total_tokens">> => 284}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873045,
          <<"id">> => <<"chatcmpl-8SnDBZhQFVeNea07NsanaBwaJvfMN">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 216,
                <<"total_tokens">> => 247}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => <<"Your room id is 2.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873044,
          <<"id">> => <<"chatcmpl-8SnDAQTDYB5O3jGZKYsLpib03DHQG">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 8,<<"prompt_tokens">> => 192,
                <<"total_tokens">> => 200}}, 
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"house_id\": 42\n}">>,
                             <<"name">> => <<"list_rooms">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873043,
          <<"id">> => <<"chatcmpl-8SnD9WI6OnhGExk2xJ0WzY9v91rXn">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 16,<<"prompt_tokens">> => 134,
                <<"total_tokens">> => 150}}],
   request =>
       #{functions =>
             [#{description =>
                    <<"change the lighting color of the selected room.">>,
                name => update_color,
                parameters =>
                    #{properties =>
                          #{color =>
                                #{description =>
                                      <<"name of the color to change. leave it empty for default.">>,
                                  type => string},
                            house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer},
                            room_id =>
                                #{description => <<"id of the room">>,
                                  type => integer}},
                      required => [house_id,room_id],
                      type => object}},
              #{description => <<"list rooms in the house.">>,
                name => list_rooms,
                parameters => 
                    #{properties =>
                          #{house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer}},
                      required => [house_id],
                      type => object}}],
         messages =>
             [#{content =>
                    <<"I'm sorry, but I am not able to change the color of the main room.">>,
                role => assistant},
              #{content =>
                    <<"{\"detail\":\"<<\\\"You can't do anything to that room.\\\">>\",\"reaseon\":\"forbidden\",\"sccess\":f"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 1\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content =>
                    <<"Can you change the main room color to blue?">>,
                role => user},
              #{content =>
                    <<"I'm sorry, but your room color is already blue. There is no need to change i"...>>,
                role => assistant},
              #{content =>
                    <<"{\"detail\":\"<<\\\"The room color is already blue.\\\">>\",\"reaseon\":\"same_colo"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content =>
                    <<"Can you change my room color to blue again?">>,
                role => user},
              #{content =>
                    <<"Sure! I have changed your room color to blue.">>,
                role => assistant},
              #{content =>
                    <<"{\"payload\":\"The room color has been changed to blue.\",\"s"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_i"...>>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content => <<"Can you change my room color to blue?">>,
                role => user},
              #{content => <<"Your room id is 2.">>,role => assistant},
              #{content =>
                    <<"{\"payload\":\"[{\\\"id\\\":1,\\\"name\\\":\\\"main r"...>>,
                name => <<"list_rooms">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> => <<"{\n  \"house_id\": 42\n}">>,
                      <<"name">> => <<"list_rooms">>},
                role => assistant},
              #{content => <<"What is my room id?">>,role => user},
              #{content => <<"You are an ai assistant of k"...>>,
                role => system}],
         model => <<"gpt-3.5-turbo">>,temperature => 0.7}}}
11> {Res5, Chat8} = chat_gpte:ask(<<"Why can't you change the color?">>, Chat7).
{<<"I apologize for the inconvenience. The main room color cannot be changed because it is not supported by the syst"...>>,
 #{functions =>
       #{<<"list_rooms">> =>
             #{description => <<"list rooms in the house.">>,
               function => #Fun<erl_eval.43.65746770>,name => list_rooms,
               properties =>
                   #{house_id =>
                         #{description => <<"id of the house">>,
                           type => integer}},
               required => #{house_id => []},
               state => []},
         <<"update_color">> =>
             #{description =>
                   <<"change the lighting color of the selected room.">>,
               function => #Fun<erl_eval.43.65746770>,name => update_color,
               properties =>
                   #{color =>
                         #{description =>
                               <<"name of the color to change. leave it empty for default.">>,
                           type => string},
                     house_id =>
                         #{description => <<"id of the house">>,
                           type => integer},
                     room_id =>
                         #{description => <<"id of the room">>,
                           type => integer}},
               required => #{house_id => [],room_id => []},
               state => <<"blue">>}},
   payloads =>
       [#{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"I apologize for the inconvenience. The main room color cannot be changed because it "...>>,
                       <<"role">> => <<"assistant">>}}], 
          <<"created">> => 1701873052,
          <<"id">> => <<"chatcmpl-8SnDI3TWlZBIO3D42TfNMP96TdKhz">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 34,<<"prompt_tokens">> => 508,
                <<"total_tokens">> => 542}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"I'm sorry, but I am not able to change the color of the main room.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873051,
          <<"id">> => <<"chatcmpl-8SnDHMs2PRfLPj9FA2kmNpYNefRUO">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 19,<<"prompt_tokens">> => 474,
                <<"total_tokens">> => 493}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 1\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873050,
          <<"id">> => <<"chatcmpl-8SnDGgsCYXIDjv6EVRn5cSM0RdI3m">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 406,
                <<"total_tokens">> => 437}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"I'm sorry, but your room color is already blue. There is no need to chan"...>>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873049,
          <<"id">> => <<"chatcmpl-8SnDFBBBLmRNgqTkZrJUtBMjtPnlX">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 22,<<"prompt_tokens">> => 367,
                <<"total_tokens">> => 389}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873047,
          <<"id">> => <<"chatcmpl-8SnDDleL8WV2O58WFjKU4nNVgm93U">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 301,
                <<"total_tokens">> => 332}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> =>
                           <<"Sure! I have changed your room color to blue.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873046,
          <<"id">> => <<"chatcmpl-8SnDC9TAf8z0GRMr1TOIN8cSvwdji">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 12,<<"prompt_tokens">> => 272,
                <<"total_tokens">> => 284}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                             <<"name">> => <<"update_color">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873045,
          <<"id">> => <<"chatcmpl-8SnDBZhQFVeNea07NsanaBwaJvfMN">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null, 
          <<"usage">> =>
              #{<<"completion_tokens">> => 31,<<"prompt_tokens">> => 216,
                <<"total_tokens">> => 247}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"stop">>,<<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => <<"Your room id is 2.">>,
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873044,
          <<"id">> => <<"chatcmpl-8SnDAQTDYB5O3jGZKYsLpib03DHQG">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 8,<<"prompt_tokens">> => 192,
                <<"total_tokens">> => 200}},
        #{<<"choices">> =>
              [#{<<"finish_reason">> => <<"function_call">>,
                 <<"index">> => 0,
                 <<"message">> =>
                     #{<<"content">> => null,
                       <<"function_call">> =>
                           #{<<"arguments">> =>
                                 <<"{\n  \"house_id\": 42\n}">>,
                             <<"name">> => <<"list_rooms">>},
                       <<"role">> => <<"assistant">>}}],
          <<"created">> => 1701873043,
          <<"id">> => <<"chatcmpl-8SnD9WI6OnhGExk2xJ0WzY9v91rXn">>,
          <<"model">> => <<"gpt-3.5-turbo-0613">>,
          <<"object">> => <<"chat.completion">>,
          <<"system_fingerprint">> => null,
          <<"usage">> =>
              #{<<"completion_tokens">> => 16,<<"prompt_tokens">> => 134,
                <<"total_tokens">> => 150}}],
   request =>
       #{functions =>
             [#{description =>
                    <<"change the lighting color of the selected room.">>,
                name => update_color,
                parameters =>
                    #{properties =>
                          #{color =>
                                #{description =>
                                      <<"name of the color to change. leave it empty for default.">>,
                                  type => string},
                            house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer},
                            room_id =>
                                #{description => <<"id of the room">>,
                                  type => integer}},
                      required => [house_id,room_id],
                      type => object}},
              #{description => <<"list rooms in the house.">>,
                name => list_rooms,
                parameters =>
                    #{properties =>
                          #{house_id =>
                                #{description => <<"id of the house">>,
                                  type => integer}},
                      required => [house_id],
                      type => object}}],
         messages =>
             [#{content =>
                    <<"I apologize for the inconvenience. The main room color cannot be changed because it is not s"...>>,
                role => assistant},
              #{content => <<"Why can't you change the color?">>,
                role => user},
              #{content =>
                    <<"I'm sorry, but I am not able to change the color of the main room.">>,
                role => assistant},
              #{content =>
                    <<"{\"detail\":\"<<\\\"You can't do anything to that room.\\\">>\",\"reaseon\":\"forbidden\",\"s"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 1\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content =>
                    <<"Can you change the main room color to blue?">>,
                role => user},
              #{content =>
                    <<"I'm sorry, but your room color is already blue. There is no need to "...>>,
                role => assistant},
              #{content =>
                    <<"{\"detail\":\"<<\\\"The room color is already blue.\\\">>\",\"reaseon\":\"s"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n  \"room_id\": 2\n}">>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content =>
                    <<"Can you change my room color to blue again?">>,
                role => user},
              #{content =>
                    <<"Sure! I have changed your room color to blue.">>,
                role => assistant},
              #{content =>
                    <<"{\"payload\":\"The room color has been changed to b"...>>,
                name => <<"update_color">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> =>
                          <<"{\n  \"color\": \"blue\",\n  \"house_id\": 42,\n "...>>,
                      <<"name">> => <<"update_color">>},
                role => assistant},
              #{content => <<"Can you change my room color to blue?">>,
                role => user},
              #{content => <<"Your room id is 2.">>,role => assistant},
              #{content =>
                    <<"{\"payload\":\"[{\\\"id\\\":1,\\\"name\\\":"...>>,
                name => <<"list_rooms">>,role => function},
              #{content => null,
                function_call =>
                    #{<<"arguments">> => <<"{\n  \"house_id\": 42\n}">>,
                      <<"name">> => <<"list_rooms">>},
                role => assistant},
              #{content => <<"What is my room id?">>,role => user},
              #{content => <<"You are an ai assist"...>>,role => system}],
         model => <<"gpt-3.5-turbo">>,temperature => 0.7}}}
12> io:format("~s~n~s~n~s~n~s~n~s~n", [Res1, Res2, Res3, Res4, Res5]).
Your room id is 2.
Sure! I have changed your room color to blue.
I'm sorry, but your room color is already blue. There is no need to change it again.
I'm sorry, but I am not able to change the color of the main room.
I apologize for the inconvenience. The main room color cannot be changed because it is not supported by the system or it may have certain restrictions set by the house owner.
ok
